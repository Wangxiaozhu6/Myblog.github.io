# Myblog.github.io
# ARTS_WEEK_6
跌跌撞撞、要坚持啊！
# tips:
    最近接到一个比较棘手的项目，之前没有参与过设计和调试，现在需要紧急的系统维护和扩展。系统控制采用MFC机制，C++语言编写而成。现主要任务调试伺服电机的原点复位功能，通过以轮廓廓形算法作为判断条件语句，让伺服电机合理的区间进行驱动。现遇到难点有二：1.Mfc的运行机制如何？2.通讯写入电机相关寄存器命令形式不确定。       
    当然也解决了很多书本上看过并没有注意到的问题，收获蛮大的。      
一.MSComm32.ocx.这个控件由于是针对win32，vs2010设计的，所以装x64位系统总会存在不兼容的状态，后来发现将组件放置C:\windows\sysWOW64\子目录下，控件即可安装成功，
如若发现xxxxxxxx.dll并未安装成功，只要以计算机管理员的方式运行一下cmd即可解决。（系统文件、计算机权限不够）另外简单介绍下MSComm控件：       
MSComm控件通过串行端口传输和接受数据的，为应用程序提供串行通讯功能。Microsoft Communications Control（简称MSComm）是Microsoft公司提供的简化Windows下串行通信编程的ActiveX控件。它为应用程序提供了通过串行接口收发数据的简便方法。
具体的来说，它提供了两种处理通信问题的方法：
```
1.事件驱动(Event－driven)方法
       事件驱动通讯是处理串行端口交互作用的一种非常有效的方法。在许多情况下，在事件发生时需要得到通知。
       例如，在串口接收缓冲区中有字符，或者 Carrier Detect (CD) 或 Request To Send (RTS) 线上一个字符到达或一个变化发生时。在这些情况下，可以利用 MSComm 控件的 OnComm 事件捕获并处理这些通讯事件。
       OnComm 事件还可以检查和处理通讯错误。所有通讯事件和通讯错误的列表，参阅 CommEvent 属性。在编程过程中，就可以在OnComm事件处理函数中加入自己的处理代码。
       这种方法的优点是程序响应及时，可靠性高。每个MSComm 控件对应着一个串行端口。如果应用程序需要访问多个串行端口，必须使用多个 MSComm 控件。
2.查询法
       查询方式实质上还是事件驱动。但在有些情况下，这种方式显得更为便捷。在程序的每个关键功能之后，可以通过检查 CommEvent 属性的值来查询事件和错误。如果应用程序较小，并且是自保持的，这种方法可能是更可取的。
```
属性：[mscomm在vs中如何实现串口通信](https://blog.csdn.net/qq_41498261/article/details/83012466)贴上来。      
二.即是MFc的运行机制。这个问题提出来了，解决一半、还需深入。[MFc运行机制](https://blog.csdn.net/icelolipop/article/details/18883345)
